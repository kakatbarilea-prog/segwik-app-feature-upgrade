<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Segwik Upgrade Flow</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
  :root{
    --bg:#f6f8fb;
    --card:#ffffff;
    --ink:#1f2937;
    --muted:#7b8794;
    --line:#e7edf5;
    --accent:#2c7dbf;
    --priceRed:#dc2626;


    --tab:#8b96a8;
    --tabActive:#2c7dbf;

    --phone-w:430px;
    --phone-h:800px;
    --footer-h:74px;
    --head-h:56px;

    --radius:18px;
    --shadow:0 20px 60px rgba(0,0,0,.12),0 8px 16px rgba(0,0,0,.08);
    --shadow2:0 10px 26px rgba(15,45,86,.08);
    --shadow3:0 8px 20px rgba(15,45,86,.06);
  }

  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:var(--bg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--ink)}
  .wrap{display:flex;align-items:center;justify-content:center;min-height:100%;padding:18px}

  /* phone shell */
  .phone{
    width:var(--phone-w);
    height:var(--phone-h);
    background:#fff;
    border-radius:34px;
    box-shadow:var(--shadow);
    border:8px solid #111;
    overflow:hidden;
    display:flex;
    flex-direction:column;
    position:relative;
  }

  /* screen stack */
  .screens{position:relative;flex:1;overflow:hidden;background:var(--bg)}
  .screen{
    position:absolute;inset:0;
    display:flex;flex-direction:column;
    transform:translateX(0);
    opacity:1;
    transition:transform .35s ease, opacity .35s ease;
    will-change:transform, opacity;
  }
  .screen.hidden{opacity:0;pointer-events:none}
  .screen.off-right{transform:translateX(100%);opacity:0;pointer-events:none}
  .screen.off-left{transform:translateX(-12%);opacity:0;pointer-events:none}

  /* topbar */
  .topbar{
    height:var(--head-h);
    display:flex;
    align-items:center;
    justify-content:center;
    border-bottom:1px solid var(--line);
    background:#fff;
    position:sticky;top:0;z-index:5;
  }
  .topbar .title{
    font-weight:700;
    color:var(--accent);
    font-size:18px;
    letter-spacing:.2px;
  }
  .topbar .backBtn{
    position:absolute;
    left:10px;
    width:36px;height:36px;
    border-radius:10px;
    border:1px solid var(--line);
    display:grid;place-items:center;
    cursor:pointer;
    background:#fff;
    color:#111;
  }
  .topbar .backBtn svg{width:18px;height:18px;stroke:currentColor;fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}

  /* content area */
  .content{
    flex:1;
    overflow:auto;
    background:var(--bg);
    padding:12px 12px calc(var(--footer-h) + 14px);

    scrollbar-width:none;
    -ms-overflow-style:none;
    -webkit-overflow-scrolling:touch;
    overscroll-behavior:contain;
  }
  .content::-webkit-scrollbar{width:0;height:0;display:none}

  /* bottom tabs */
  .tabs{
    height:var(--footer-h);
    border-top:1px solid var(--line);
    background:#fff;
    display:grid;
    grid-template-columns:repeat(5,1fr);
    padding:6px 6px 8px;
    position:absolute;
    bottom:0;left:0;right:0;
    z-index:6;
  }
  .tab{
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    gap:4px;
    color:var(--tab);
    font-size:11px;
    font-weight:600;
  }
  .tab svg{width:20px;height:20px;stroke:currentColor;fill:none;stroke-width:2}
  .tab.active{color:var(--tabActive);font-weight:700}

  /* cards */
  .card{
    background:var(--card);
    border:1px solid var(--line);
    border-radius:22px;
    box-shadow:var(--shadow3);
    padding:14px;
    margin:10px 0;
  }

  .heroCard{
    background:#fff;
    border:1px solid var(--line);
    border-radius:22px;
    box-shadow:var(--shadow2);
    padding:16px;
    margin:2px 0 12px;
  }

  .sectionTitle{
    font-weight:700;
    font-size:13px;
    color:#0b1b2b;
    margin:14px 0 8px;
    display:flex;
    align-items:center;
    gap:10px;
  }
  .sectionTitle .dot{width:9px;height:9px;border-radius:999px;background:var(--accent);opacity:.85}

  .mutedLine{
    color:#64748b;
    font-size:12px;
    line-height:1.35;
    font-weight:600;
  }

  /* locked header rows */
  .lockRow{
    display:flex;align-items:center;gap:12px;
  }
  .lockIcon{
    width:42px;height:42px;border-radius:14px;
    background:rgba(44,125,191,.10);
    border:1px solid rgba(44,125,191,.18);
    display:grid;place-items:center;
    color:var(--accent);
    flex:0 0 auto;
  }
  .lockIcon svg{width:20px;height:20px;stroke:currentColor;fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}
  .lockMeta{min-width:0}
  .lockKicker{
    font-size:12px;color:#64748b;font-weight:700;
  }
  .lockNeed{
    margin-top:4px;
    font-size:15px;
    font-weight:00;
    color:#0b1b2b;
    line-height:1.2;
  }

  .miniGrid{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:10px;
    margin-top:12px;
  }

    .miniGrid.oneCol{
    grid-template-columns:1fr;
  }

  .linkSmall{
    appearance:none;
    border:0;
    background:transparent;
    padding:0;
    margin:0;
    font:inherit;
    color:var(--accent);
    font-weight:700;
    font-size:12px;
    cursor:pointer;
    text-decoration:underline;
    text-underline-offset:3px;
  }

  .planLinkBtn{
    appearance:none;
    border:0;
    background:transparent;
    padding:0;
    margin:0;
    font:inherit;
    cursor:pointer;
    font-weight:700;
    color:#0b1b2b;
    text-underline-offset:4px;
  }

  .featurePanel{
    border:1px solid rgba(44,125,191,.18);
    background:rgba(44,125,191,.06);
    border-radius:18px;
    padding:12px 12px;
  }
  .featurePanelTitle{
    font-weight:700;
    color:#0b1b2b;
    font-size:13px;
  }
  .featurePanelSub{
    margin-top:6px;
    color:#64748b;
    font-size:12px;
    font-weight:700;
    line-height:1.35;
  }
  .featureBullets{
    margin:10px 0 0;
    padding-left:18px;
    color:#0b1b2b;
    font-size:13px;
    font-weight:650;
    line-height:1.35;
  }
  .featureBullets li{
    margin:6px 0;
  }

  .miniStat{
    border:1px solid rgba(44,125,191,.22);
    border-radius:16px;
    padding:10px 10px;
    background:rgba(44,125,191,.06);
    box-shadow:0 10px 22px rgba(15,45,86,.06);
  }

  .miniStat .k{font-size:11px;color:#8a94a6;font-weight:700}
  .miniStat .v{margin-top:4px;font-size:13px;color:#111;font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

  /* choice buckets */
  .bucket{
    border:1px solid var(--line);
    border-radius:20px;
    background:#fff;
    box-shadow:var(--shadow3);
    padding:14px;
    margin:10px 0;
    cursor:pointer;
    position:relative;
  }
  .bucket:hover{border-color:rgba(44,125,191,.32)}
  .bucket.active{
    border-color:rgba(44,125,191,.55);
    box-shadow:0 14px 26px rgba(44,125,191,.16);
  }
  /* Pro bucket variant (visually distinct from Grow) */
  .bucket.pro{
    border:1px solid rgba(15,45,86,.14);
    background:linear-gradient(180deg, rgba(15,45,86,.035), #fff);
  }
  .bucket.pro:hover{
    border-color:rgba(15,45,86,.28);
  }

  /* When Pro is toggled ON, make the whole bucket feel "armed" */
  .bucket.pro.active{
    border-color:rgba(15,45,86,.40);
    box-shadow:0 14px 26px rgba(15,45,86,.14);
  }

  /* Pro header accents */
  .bucket.pro .bucketTitle{
    color:#0b1b2b;
  }
  .bucket.pro .bucketSub{
    color:#556274;
  }

  /* Make Pro toggle + status feel intentional */
  .bucket.pro .toggle.on{
    background:rgba(34,197,94,.28);
    border-color:rgba(34,197,94,.55);
  }

  .bucketTop{
    display:flex;align-items:flex-start;justify-content:space-between;gap:10px;
  }
  .bucketTitle{
    font-size:14px;
    font-weight:700;
    color:#0b1b2b;
    line-height:1.2;
  }
  .bucketSub{
    margin-top:6px;
    font-size:12px;
    color:#5b6776;
    font-weight:600;
    line-height:1.35;
  }

  .radio{
    width:22px;height:22px;border-radius:999px;
    border:2px solid #cbd5e1;
    display:grid;
    place-items:center;
    flex:0 0 auto;
    margin-top:2px;
    background:#fff;
    position:relative;
  }

  /* default: no dot */
  .radio .dot{
    width:10px;height:10px;border-radius:999px;
    background:transparent;
  }

  /* existing behavior (Grow selection) */
  .bucket.active .radio{border-color:rgba(44,125,191,.65)}
  .bucket.active .radio .dot{background:var(--accent)}

  /* PAYMENT METHOD: show green check when selected */
  .method.active .radio{
    border-color:rgba(34,197,94,.85);
    background:rgba(34,197,94,.10);
  }
  .method.active .radio .dot{
    width:14px;
    height:14px;
    border-radius:0;
    background:transparent;
    position:relative;
  }
  .method.active .radio .dot:before{
    content:"";
    position:absolute;
    width:8px;
    height:4px;
    border-left:2.6px solid #16a34a;
    border-bottom:2.6px solid #16a34a;
    transform:rotate(-45deg);
    left:2px;
    top:4px;
  }


.featureList{
  margin-top:12px;
  display:flex;
  flex-direction:column;
  gap:12px;
}

.feat{
  display:flex;
  align-items:flex-start;
  gap:10px;
  font-size:13px;
  color:#0b1b2b;
  font-weight:600;
  line-height:1.4;
  padding:2px 0;
}

.check{
  width:18px;
  height:18px;
  border-radius:6px;
  border:1px solid rgba(44,125,191,.25);
  background:rgba(44,125,191,.08);
  color:var(--accent);
  display:grid;
  place-items:center;
  flex:0 0 auto;
  margin-top:1px;
}

.check svg{
  width:14px;
  height:14px;
  stroke:currentColor;
  fill:none;
  stroke-width:2;
  stroke-linecap:round;
  stroke-linejoin:round;
}


  .addRow{
    margin-top:10px;
    padding-top:10px;
    border-top:1px dashed rgba(44,125,191,.22);
    display:flex;align-items:center;justify-content:space-between;gap:10px;
  }
  .addMeta{min-width:0}
  .addTitle{font-size:13px;font-weight:700;color:#0b1b2b}
  .addSub{margin-top:4px;font-size:12px;font-weight:600;color:#64748b;line-height:1.3}

  .toggle{
    width:46px;height:28px;border-radius:999px;
    border:1px solid #d1d5db;
    background:#e5e7eb;
    position:relative;
    cursor:pointer;
    flex:0 0 auto;
  }
  .toggle:after{
    content:"";
    position:absolute;top:50%;left:3px;transform:translateY(-50%);
    width:22px;height:22px;border-radius:999px;background:#fff;
    box-shadow:0 6px 12px rgba(0,0,0,.12);
    transition:left .18s ease;
  }
  .toggle.on{
    background:rgba(34,197,94,.28);
    border-color:rgba(34,197,94,.55);
  }

  .toggle.on:after{left:21px}

  /* Onboarding */
  .choiceCard{
    border:1px solid var(--line);
    border-radius:20px;
    background:#fff;
    box-shadow:var(--shadow3);
    padding:14px;
    margin:10px 0;
    cursor:pointer;
    position:relative;
  }

  /* Remove radio circles ONLY inside onboarding cards */
  .choiceCard .radio{display:none !important;}

  /* Make selection visually obvious (NO extra text added) */
  .choiceCard.active{
    border-color:rgba(44,125,191,.85);
    box-shadow:
      0 18px 38px rgba(44,125,191,.22),
      0 10px 26px rgba(15,45,86,.08);
    outline-offset:3px;
    background:linear-gradient(180deg, rgba(44,125,191,.06), #fff);
  }

  /* Disabled onboarding option */
  .choiceCard.disabled{
    opacity:.55;
    filter:grayscale(1);
    cursor:not-allowed;
  }
  .choiceCard.disabled:hover{
    border-color:var(--line);
  }
  /* Safety: if it ever gets .active, keep it visually normal */
  .choiceCard.disabled.active{
    border-color:var(--line);
    box-shadow:var(--shadow3);
    background:#fff;
  }


  .choiceTop{display:flex;align-items:flex-start;justify-content:space-between;gap:10px}
  .choiceTitle{font-weight:700;font-size:14px;color:#0b1b2b;line-height:1.2}
  .choiceSub{margin-top:6px;font-weight:600;font-size:12px;color:#5b6776;line-height:1.35}
  .badge{
    border:1px solid rgba(44,125,191,.22);
    background:rgba(44,125,191,.08);
    color:#0b1b2b;
    padding:7px 10px;
    border-radius:999px;
    font-size:11px;
    font-weight:700;
    white-space:nowrap;
    flex:0 0 auto;
  }
  /* Onboarding (collapsible features) */
  .obMetaRow{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
    margin-top:10px;
  }
  .obToggleBtn{
    appearance:none;
    border:0;
    background:transparent;
    padding:0;
    margin:0;
    font:inherit;
    color:var(--accent);
    font-weight:700;
    font-size:12px;
    cursor:pointer;
    text-decoration:underline;
    text-underline-offset:3px;
    white-space:nowrap;
  }
  .obToggleBtn:active{opacity:.85}


  .obFeatures{
    display:none;
    margin-top:0;
  }


  /* Skip onboarding (highlighted) */
  .skipCard{
    border:2px dashed rgba(44,125,191,.40);
    background:rgba(44,125,191,.06);
    box-shadow:0 14px 26px rgba(44,125,191,.10);
  }

  .skipBtn{
    width:100%;
    text-align:left;
    border:2px dashed rgba(44,125,191,.40);
    background:rgba(44,125,191,.06);
    box-shadow:0 14px 26px rgba(44,125,191,.10);
    border-radius:20px;
    padding:14px;
    cursor:pointer;
    font:inherit;
  }
  .skipBtn:active{opacity:.92}
  .skipBtn .skipTitle{display:block}
  .skipBtn .skipSub{display:block}

  .skipTitle{
    font-weight:700;
    font-size:14px;
    color:#0b1b2b;
    line-height:1.25;
  }
  .skipSub{
    margin-top:6px;
    font-weight:700;
    font-size:12px;
    color:#546174;
    line-height:1.35;
  }

  /* Friendly confirmation modal */
  .modalOverlay{
    position:absolute;
    inset:0;
    background:rgba(11,27,43,.55);
    display:none;
    align-items:flex-end;
    justify-content:center;
    padding:12px;
    z-index:20;
  }
  .modalOverlay.show{display:flex}

  .modalCard{
    width:100%;
    background:#fff;
    border:1px solid var(--line);
    border-radius:22px;
    box-shadow:0 18px 40px rgba(0,0,0,.18);
    padding:16px;
  }
  .modalTitle{
    font-size:15px;
    font-weight:700;
    color:#0b1b2b;
    line-height:1.25;
  }
  .modalSub{
    margin-top:8px;
    font-size:13px;
    font-weight:650;
    color:#556274;
    line-height:1.4;
  }
  .modalOptions{
    margin-top:12px;
    border:1px solid rgba(44,125,191,.18);
    background:rgba(44,125,191,.06);
    border-radius:16px;
    padding:12px;
  }
  .modalOption{
    display:flex;
    gap:10px;
    align-items:flex-start;
    font-size:13px;
    font-weight:650;
    color:#0b1b2b;
    line-height:1.35;
    margin:8px 0;
  }

  /* Summary */
  .summaryGrid{
    display:grid;
    grid-template-columns:1fr auto;
    gap:10px 12px;
    align-items:start;
    font-size:13px;
    font-weight:600;
    margin-top:10px;
  }
  .summaryGrid .k{color:#64748b;font-weight:700}
  .summaryGrid .k.emph{color:#0b1b2b;font-weight:700}

  .summaryGrid .v{color:#0b1b2b;font-weight:700;text-align:right;white-space:nowrap}
  .divider{height:1px;background:var(--line);margin:12px 0}

  /* Buttons */
  .primaryBtn{
    width:100%;
    padding:14px 14px;
    border-radius:14px;
    border:0;
    background:var(--accent);
    color:#fff;
    font-weight:700;
    font-size:15px;
    cursor:pointer;
    box-shadow:0 10px 22px rgba(44,125,191,.22);
    margin-top:12px;
  }
  .primaryBtn:active{opacity:.85}
  .primaryBtn[disabled]{opacity:.55;cursor:not-allowed}

  .secondaryBtn{
    width:100%;
    padding:13px 14px;
    border-radius:14px;
    border:1px solid var(--line);
    background:#fff;
    color:#111;
    font-weight:700;
    font-size:15px;
    cursor:pointer;
    box-shadow:0 8px 18px rgba(15,45,86,.06);
    margin-top:10px;
  }
  .secondaryBtn:active{opacity:.88}
  /* Onboarding: true "button" look for skipping guided help */
  .skipBtn{
    width:100%;
    display:flex;
    align-items:center;
    justify-content:center;
    gap:10px;

    padding:14px 14px;
    border-radius:14px;

    border:1px solid rgba(44,125,191,.35);
    background:#fff;
    color:var(--accent);

    font-weight:700;
    font-size:14px;
    cursor:pointer;

    box-shadow:0 10px 22px rgba(44,125,191,.12);

    /* more space above, tighter below */
    margin:18px 0 8px;
  }

  .skipBtn:hover{
    border-color:rgba(44,125,191,.55);
    box-shadow:0 14px 28px rgba(44,125,191,.16);
  }
  .skipBtn:active{transform:translateY(1px);opacity:.92}

  /* When "none" is selected, make it clearly pressed/selected */
  .skipBtn.active{
    background:var(--accent);
    color:#fff;
    border-color:var(--accent);
    box-shadow:0 16px 34px rgba(44,125,191,.22);
  }

  .skipBtn .skipBtnLabel{
    line-height:1.2;
    text-align:center;
  }

  .microHint{
    font-size:12px;
    color:#6b7280;
    text-align:center;
    margin-top:8px;
    line-height:1.35;
    font-weight:600;
  }
  /* Onboarding not included row (shows after skipping) */
  .obNoRow{
    width:100%;
    border:1px solid rgba(44,125,191,.22);
    background:rgba(44,125,191,.06);
    border-radius:14px;
    padding:12px 12px;
    box-shadow:0 10px 22px rgba(15,45,86,.06);
    margin:10px 0 12px;
  }
  .obNoCheck{
    display:flex;
    align-items:center;
    gap:10px;
    font-weight:750;
    color:#0b1b2b;
    font-size:13px;
    line-height:1.25;
  }
  .obNoCheck input{
    width:18px;
    height:18px;
    accent-color:var(--accent);
    margin:0;
  }
  .obNoText{
    display:inline-block;
  }
  .obNoIcon{
    width:18px;
    height:18px;
    flex:0 0 auto;
    display:inline-block;
  }
  .obNoIcon svg{
    width:100%;
    height:100%;
    display:block;
  }

  /* Simple centered CTA screen */
  .centerStage{
    min-height:calc(var(--phone-h) - var(--head-h) - var(--footer-h) - 24px);
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .ctaCard{
    width:100%;
    background:#fff;
    border:1px solid var(--line);
    border-radius:22px;
    box-shadow:var(--shadow2);
    padding:18px;
  }
  .ctaTitle{font-size:16px;font-weight:700;color:#0b1b2b;line-height:1.2}
  .ctaSub{margin-top:8px;font-size:13px;font-weight:600;color:#64748b;line-height:1.35}

  /* Toast */
  .toast{
    position:absolute;
    left:12px;right:12px;bottom:calc(var(--footer-h) + 12px);
    background:#0b1b2b;
    color:#fff;
    padding:12px 12px;
    border-radius:16px;
    font-size:13px;
    font-weight:600;
    box-shadow:0 18px 40px rgba(0,0,0,.18);
    opacity:0;
    transform:translateY(12px);
    transition:opacity .22s ease, transform .22s ease;
    pointer-events:none;
    z-index:10;
  }
  .toast.show{opacity:1;transform:translateY(0)}
  /* Summary: "See features and credits you're getting" button */
  .sumDetailBtn{
    appearance:none;
    border:1px solid rgba(44,125,191,.28);
    background:rgba(44,125,191,.08);
    color:#0b1b2b;
    font-weight:700;
    font-size:12px;
    padding:8px 10px;
    border-radius:999px;
    cursor:pointer;
    display:none; /* only shown when there is something to show */
    line-height:1;
  }
  .sumDetailBtn:active{opacity:.88}
  /* Summary: details row sits directly under Onboarding */
  .sumDetailRow{
    grid-column:1 / -1;     /* span both columns */
    display:flex;
    justify-content:flex-start;
    margin-top:6px;
  }

  /* Summary details modal */
  .sumModalOverlay{
    position:absolute;
    inset:0;
    background:rgba(11,27,43,.55);
    display:none;
    align-items:flex-end;
    justify-content:center;
    padding:12px;
    z-index:25;
  }
  .sumModalOverlay.show{display:flex}

  .sumModalCard{
    width:100%;
    background:#fff;
    border:1px solid var(--line);
    border-radius:22px;
    box-shadow:0 18px 40px rgba(0,0,0,.18);
    padding:16px;
  }
  .sumModalTop{
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    gap:10px;
  }
  .sumModalTitle{
    font-size:15px;
    font-weight:700;
    color:#0b1b2b;
    line-height:1.25;
  }
  .sumModalClose{
    width:36px;height:36px;
    border-radius:12px;
    border:1px solid var(--line);
    background:#fff;
    cursor:pointer;
    display:grid;place-items:center;
    color:#111;
    flex:0 0 auto;
  }
  .sumModalClose svg{width:18px;height:18px;stroke:currentColor;fill:none;stroke-width:2;stroke-linecap:round}
  .sumModalBody{
    margin-top:12px;
    border:1px solid rgba(44,125,191,.18);
    background:rgba(44,125,191,.06);
    border-radius:16px;
    padding:12px;

    /* scroll */
    max-height:52vh;
    overflow:auto;
    -webkit-overflow-scrolling:touch;
  }

  /* scrollbar styling */
  .sumModalBody::-webkit-scrollbar{width:10px}
  .sumModalBody::-webkit-scrollbar-track{background:rgba(0,0,0,.06);border-radius:999px}
  .sumModalBody::-webkit-scrollbar-thumb{background:rgba(44,125,191,.35);border-radius:999px}
  .sumModalBody::-webkit-scrollbar-thumb:hover{background:rgba(44,125,191,.50)}

  .sumModalSection{
    font-size:12px;
    font-weight:700;
    color:#64748b;
    letter-spacing:.2px;
    margin:10px 0 6px;
  }
  .sumModalSection:first-child{margin-top:0}
  .sumModalList{
    margin:0;
    padding-left:18px;
    color:#0b1b2b;
    font-size:13px;
    font-weight:650;
    line-height:1.35;
  }
  .sumModalList li{margin:6px 0}

    /* Onboarding screen: bring Continue closer to the skip button */
  #screen-onboarding .primaryBtn{
    margin-top:8px;
  }
  /* SUMMARY PRICING: make labels + prices red */
  #screen-summary .summaryGrid .k.emph{
    color:var(--priceRed) !important;
  }
  #screen-summary .summaryGrid .v#sumRecurring,
  #screen-summary .summaryGrid .v#sumOnetime{
    color:var(--priceRed) !important;
  }
  /* ======================================================
     PAYMENT METHOD FLOW (ADD-ON)
     - methods + card form + loader + security note
  ====================================================== */

  /* Button loader (inline, 2s fake processing) */
  .primaryBtn{position:relative}
  .primaryBtn.loading{cursor:not-allowed;opacity:.92}
  .primaryBtn.loading .btnText{opacity:0}
  .primaryBtn.loading .btnSpinner{opacity:1}
  .btnSpinner{
    position:absolute;
    left:50%;
    top:50%;
    transform:translate(-50%,-50%);
    width:18px;
    height:18px;
    border-radius:999px;
    border:2px solid rgba(255,255,255,.45);
    border-top-color:#ffffff;
    opacity:0;
    animation:spin .85s linear infinite;
    pointer-events:none;
  }
  @keyframes spin{
    to{transform:translate(-50%,-50%) rotate(360deg)}
  }

  /* Payment methods */
  .method{
    border:1px solid var(--line);
    border-radius:20px;
    background:#fff;
    box-shadow:var(--shadow3);
    padding:14px;
    margin:10px 0;
    cursor:pointer;
    position:relative;
  }
  .method:hover{border-color:rgba(44,125,191,.32)}
  .method.active{
    border-color:rgba(44,125,191,.65);
    box-shadow:0 14px 26px rgba(44,125,191,.16);
  }
  .methodTop{display:flex;align-items:flex-start;justify-content:space-between;gap:10px}
  .methodTitle{font-size:14px;font-weight:700;color:#0b1b2b;line-height:1.2}
  .methodSub{margin-top:6px;font-size:12px;color:#5b6776;font-weight:600;line-height:1.35}

  /* Security note */
  .securityNote{
    margin-top:12px;
    border:1px solid rgba(44,125,191,.18);
    background:rgba(44,125,191,.06);
    border-radius:16px;
    padding:12px;
    display:flex;
    gap:10px;
    align-items:flex-start;
  }
  .secIcon{
    width:34px;height:34px;
    border-radius:12px;
    display:grid;place-items:center;
    background:rgba(44,125,191,.12);
    border:1px solid rgba(44,125,191,.20);
    color:var(--accent);
    flex:0 0 auto;
  }
  .secTitle{font-weight:700;color:#0b1b2b;font-size:13px;line-height:1.2}
  .secText{margin-top:5px;color:#5b6776;font-size:12px;font-weight:600;line-height:1.35}

  /* Credit card form */
  .payShell{
    border:1px solid var(--line);
    border-radius:18px;
    padding:12px;
    background:#fff;
    box-shadow:0 10px 22px rgba(15,45,86,.05);
  }
  .row{display:flex;gap:10px}
  .row + .row{margin-top:10px}
  .col{flex:1;min-width:0}

  .label{
    font-size:11px;
    color:#8a94a6;
    font-weight:700;
    letter-spacing:.2px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
  }

  .ccField{
    width:100%;
    border:1px solid var(--line);
    background:#fff;
    border-radius:14px;
    padding:12px 12px;
    font-size:14px;
    font-weight:500;
    outline:none;
  }
  .ccField:focus{
    border-color:rgba(44,125,191,.55);
    box-shadow:0 0 0 3px rgba(44,125,191,.10);
  }

  .ccNumberWrap{position:relative}
  .brandStrip{
    position:absolute;
    right:10px;
    top:50%;
    transform:translateY(-50%);
    display:flex;
    gap:8px;
    align-items:center;
    pointer-events:none;
  }

  /* Card brand logos (pure CSS) */
  .brandLogo{
    width:34px;
    height:22px;
    border-radius:6px;
    border:1px solid rgba(15,45,86,.12);
    background:#ffffff;
    box-shadow:0 6px 14px rgba(15,45,86,.08);
    position:relative;
    overflow:hidden;
  }
  .brandLogo.visa{
    background:linear-gradient(135deg,#0b2a6f 0%, #123a92 55%, #0b2a6f 100%);
  }
  .brandLogo.visa:after{
    content:"VISA";
    position:absolute;
    right:6px;
    bottom:4px;
    font-size:9px;
    font-weight:700;
    letter-spacing:.6px;
    color:#ffffff;
    opacity:.95;
  }
  .brandLogo.mc{background:#ffffff}
  .brandLogo.mc:before,
  .brandLogo.mc:after{
    content:"";
    position:absolute;
    top:50%;
    width:13px;
    height:13px;
    border-radius:50%;
    transform:translateY(-50%);
    opacity:.96;
  }
  .brandLogo.mc:before{left:9px;background:#eb001b}
  .brandLogo.mc:after{left:15px;background:#f79e1b;mix-blend-mode:multiply}

  .brandLogo.amex{
    background:linear-gradient(135deg,#0b8bbd 0%, #0a6fa1 55%, #0b8bbd 100%);
  }
  .brandLogo.amex:after{
    content:"AMEX";
    position:absolute;
    left:6px;
    bottom:4px;
    font-size:9px;
    font-weight:700;
    letter-spacing:.5px;
    color:#ffffff;
    opacity:.95;
  }
  .brandLogo.amex:before{
    content:"";
    position:absolute;
    inset:0;
    background:repeating-linear-gradient(
      90deg,
      rgba(255,255,255,.08) 0px,
      rgba(255,255,255,.08) 2px,
      rgba(255,255,255,0) 2px,
      rgba(255,255,255,0) 4px
    );
    opacity:.55;
  }

  .brandLogo.disc{background:#ffffff}
  .brandLogo.disc:before{
    content:"";
    position:absolute;
    left:-6px;
    top:50%;
    width:24px;
    height:24px;
    border-radius:50%;
    transform:translateY(-50%);
    background:radial-gradient(circle at 45% 45%, #ff9a2a 0%, #ff6a00 60%, rgba(255,106,0,0) 62%);
    opacity:.95;
  }
  .brandLogo.disc:after{
    content:"DISC";
    position:absolute;
    right:6px;
    bottom:4px;
    font-size:9px;
    font-weight:700;
    letter-spacing:.45px;
    color:#111827;
    opacity:.85;
  }

  .inlineInfo{
    margin-top:10px;
    padding:10px 10px;
    border-radius:14px;
    background:rgba(15,45,86,.04);
    border:1px solid rgba(15,45,86,.08);
    display:flex;
    gap:10px;
    align-items:flex-start;
  }
  .inlineInfo .i{
    width:28px;height:28px;border-radius:10px;
    background:rgba(44,125,191,.10);
    border:1px solid rgba(44,125,191,.18);
    color:var(--accent);
    display:grid;place-items:center;
    flex:0 0 auto;
    font-size:13px;
  }
  .inlineInfo .t{
    font-size:12px;
    color:#556274;
    font-weight:600;
    line-height:1.35;
  }
  .inlineInfo .t{
    font-size:12px;
    color:#556274;
    font-weight:600;
    line-height:1.35;
  }

  /* ======================================================
     SUCCESS SCREEN: BLUR + PAYMENT CONFIRMED POPUP
  ====================================================== */
  .blurred{
    filter:blur(7px);
    transform:translateZ(0);
  }

  .payConfirmOverlay{
    position:absolute;
    inset:0;
    background:rgba(11,27,43,.55);
    display:none;
    align-items:center;
    justify-content:center;
    padding:14px;
    z-index:40;
  }
  .payConfirmOverlay.show{display:flex}

  .payConfirmCard{
    width:100%;
    max-width:360px;
    background:#fff;
    border:1px solid var(--line);
    border-radius:22px;
    box-shadow:0 18px 40px rgba(0,0,0,.18);
    padding:16px;
  }
  .payConfirmTitle{
    font-size:16px;
    font-weight:700;
    color:#0b1b2b;
    line-height:1.2;
  }
  .payConfirmSub{
    margin-top:8px;
    font-size:13px;
    font-weight:650;
    color:#556274;
    line-height:1.4;
  }

  /* Success summary */
  .successHero{
    background:#fff;
    border:1px solid var(--line);
    border-radius:22px;
    box-shadow:var(--shadow2);
    padding:16px;
    margin:2px 0 12px;
  }
  .successHeroTitle{
    font-size:15px;
    font-weight:700;
    color:#0b1b2b;
    line-height:1.2;
  }
  .successHeroSub{
    margin-top:8px;
    font-size:12px;
    font-weight:650;
    color:#64748b;
    line-height:1.35;
  }

  .creditGrid{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:10px;
    margin-top:12px;
  }
  .creditGrid.oneCol{grid-template-columns:1fr}
  .creditBox{
    border:1px solid rgba(44,125,191,.22);
    border-radius:16px;
    padding:10px 10px;
    background:rgba(44,125,191,.06);
    box-shadow:0 10px 22px rgba(15,45,86,.06);
  }
  .creditBox .k{font-size:11px;color:#8a94a6;font-weight:700}
  .creditBox .v{margin-top:4px;font-size:14px;color:#111;font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

  .successListWrap{
    border:1px solid rgba(44,125,191,.18);
    background:rgba(44,125,191,.06);
    border-radius:16px;
    padding:12px;
    margin-top:10px;

    max-height:44vh;
    overflow:auto;
    -webkit-overflow-scrolling:touch;
  }
  .successListWrap::-webkit-scrollbar{width:10px}
  .successListWrap::-webkit-scrollbar-track{background:rgba(0,0,0,.06);border-radius:999px}
  .successListWrap::-webkit-scrollbar-thumb{background:rgba(44,125,191,.35);border-radius:999px}
  .successListWrap::-webkit-scrollbar-thumb:hover{background:rgba(44,125,191,.50)}

</style>
</head>

<body>
<div class="wrap">
  <div class="phone">
    <div class="screens">

      <!-- Screen 1: Global entry point used everywhere an upgrade is needed -->
      <div class="screen" id="screen-entry">
        <div class="topbar">
<div class="title" style="text-align:center;">
  <img src="https://d34hmiuaex7c0.cloudfront.net/2952/uploads/1749465920524.png"
       style="width:30%; height:auto; padding-top: 10px;"
       alt="Projects Icon">
</div>
        </div>

        <div class="content">
          <div class="centerStage">
            <div class="ctaCard">
              <div class="ctaTitle">Unlock feature</div>
              <div class="ctaSub">Enable the capability you tried to access.</div>
              <button class="primaryBtn" style="margin-top:14px;" onclick="openLocked(state.featureName, state.needsPlan)">
                Unlock feature
              </button>
              <div class="microHint">You can manage upgrades anytime in Settings.</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Screen 2: Feature requirement + actions (immediate) -->
      <div class="screen off-right hidden" id="screen-locked" aria-hidden="true">
        <div class="topbar">
          <div class="backBtn" onclick="navBack()">
            <svg viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg>
          </div>
          <div class="title">Upgrade Your Segwik Account</div>
        </div>

        <div class="content">
          <div class="heroCard">
            <div class="lockRow">
              <div class="lockIcon">
                <svg viewBox="0 0 24 24">
                  <path d="M7 11V8a5 5 0 0 1 10 0v3"/>
                  <path d="M6 11h12v10H6z"/>
                </svg>
              </div>
              <div class="lockMeta">
                <div class="lockKicker">This feature requires an upgrade to</div>
                <div class="lockNeed" id="needText">—</div>
              </div>
            </div>

            <div class="miniGrid oneCol">
              <div class="miniStat">
                <div class="k">Current subscription</div>
                <div class="v" id="currentPlan">—</div>
              </div>
            </div>
          </div>
          <div class="bucket" id="bucket-grow" onclick="selectBucket('grow')">
            <div class="bucketTop">
              <div style="min-width:0;">
                <div class="bucketTitle">Enable Grow capabilities</div>
                <div class="bucketSub">Unlock the core tools most teams need day to day.</div>
              </div>
              <div class="radio" aria-hidden="true"><div class="dot"></div></div>
            </div>

            <div style="margin-top:10px;text-align:left;">
              <button type="button" class="linkSmall" id="growFeaturesToggleBtn" onclick="event.stopPropagation(); toggleBucketFeatures('grow');">See full features</button>

            </div>

            <div class="featureList" id="growFeaturesList" style="display:none;">
              <div class="feat">Everything in Segwik Start PLUS:</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Telecommunications Credit - 100 Credits</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Active Connections Credits - 500 Credits</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> User Credits - 5 Credits</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Segwik CORE Desktop</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Relationship Manager 360º Plus</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> AI Customer Journey Manager</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> AI Productivity Feed</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Advanced Meetings Module</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Calendar Booker</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Business Card Scanner</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Mass Email Blasting System</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> AI Content Generator</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Smart Conversations Manager</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Google Calendar Sync</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Segwik Marketplace</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Basic Segwik Email Sending</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Account Customization</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Contact Personalization</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Call Transcription</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Integration Setup</div>
            </div>



          </div>

          <div class="bucket pro" id="bucket-pro" onclick="togglePro()">
            <div class="bucketTop">
              <div style="min-width:0;">
                <div class="bucketTitle">Add Pro capabilities</div>
                <div class="bucketSub">Layer in advanced controls and automation.</div>
              </div>
              <div class="toggle" id="proToggle" role="switch" aria-checked="false"></div>
            </div>

            <div style="margin-top:10px;text-align:left;">
              <button type="button" class="linkSmall" id="proFeaturesToggleBtn" onclick="event.stopPropagation(); toggleBucketFeatures('pro');">See full features</button>

            </div>

            <div class="featureList" id="proFeaturesList" style="display:none;margin-top:12px;" onclick="event.stopPropagation();">
              <div class="feat">Everything in Grow PLUS:</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Telecommunications Credit - 250 Credits</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Active Connections Credits - 500 Credits</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> User Credits - 15 Credits</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Optional “Micro Kits” / Add-On Blocks</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Secure Customer Portal</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Advanced Content Manager</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> SMS Texting Compliance Setup</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Text Blast Module</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> CRM Technology & AI Foundations</div>
            </div>



          </div>

          <button class="primaryBtn" id="capContinue" onclick="navTo('screen-onboarding')">
            Continue
          </button>

          <div class="microHint" id="capHint">Select Grow to continue.</div>

          <div class="card" id="fullFeaturesLocked" style="display:none;" hidden>




            <div class="featurePanel" style="margin-top:0;">
              <div class="featurePanelTitle">Segwik Grow</div>
              <div class="featurePanelSub">Everything in Segwik Start PLUS:</div>
              <ul class="featureBullets">
                <li>Telecommunications Credit - 100 Credits</li>
                <li>Active Connections Credits - 500 Credits</li>
                <li>User Credits - 5 Credits</li>
                <li>Segwik CORE Desktop</li>
                <li>Relationship Manager 360º Plus</li>
                <li>AI Customer Journey Manager</li>
                <li>AI Productivity Feed</li>
                <li>Advanced Meetings Module</li>
                <li>Calendar Booker</li>
                <li>Business Card Scanner</li>
                <li>Mass Email Blasting System</li>
                <li>AI Content Generator</li>
                <li>Smart Conversations Manager</li>
                <li>Google Calendar Sync</li>
                <li>Segwik Marketplace</li>
                <li>Basic Segwik Email Sending</li>
                <li>Account Customization</li>
                <li>Contact Personalization</li>
                <li>Call Transcription</li>
                <li>Integration Setup</li>
              </ul>
            </div>

            <div class="featurePanel" style="margin-top:12px;">
              <div class="featurePanelTitle">Pro</div>
              <div class="featurePanelSub">Everything in Grow PLUS:</div>
              <ul class="featureBullets">
                <li>Telecommunications Credit - 250 Credits</li>
                <li>Active Connections Credits - 500 Credits</li>
                <li>User Credits - 15 Credits</li>
                <li>Optional “Micro Kits” / Add-On Blocks</li>
                <li>Secure Customer Portal</li>
                <li>Advanced Content Manager</li>
                <li>SMS Texting Compliance Setup</li>
                <li>Text Blast Module</li>
                <li>CRM Technology &amp; AI Foundations</li>
              </ul>
            </div>
          </div>


        </div>
      </div>

      <!-- Screen 3: Capabilities selection (no pricing copy anywhere) -->
      <div class="screen off-right hidden" id="screen-capabilities" aria-hidden="true" hidden>
        <div class="topbar">
          <div class="backBtn" onclick="navBack()">
            <svg viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg>
          </div>
          <div class="title">Capabilities</div>
        </div>

        <div class="content">
          <div class="miniGrid" style="margin-top:2px;">
            <div class="miniStat">
              <div class="k">Feature</div>
              <div class="v" id="capFeature">—</div>
            </div>
            <div class="miniStat">
              <div class="k">Current subscription</div>
              <div class="v" id="capCurrentPlan">—</div>
            </div>
          </div>


          <div class="bucket" id="bucket-grow">
            <div class="bucketTop">
              <div style="min-width:0;">
                <div class="bucketTitle">Enable Grow capabilities</div>
                <div class="bucketSub">Unlock the core tools most teams need day to day.</div>
              </div>
              <div class="radio" aria-hidden="true"><div class="dot"></div></div>
            </div>

            <div class="featureList">
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Save reusable workflows and checklists</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Assign tasks to teammates with accountability</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Track projects with milestones and due dates</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Simple reporting across workstreams</div>
            </div>
          </div>

          <div class="bucket pro" id="bucket-pro" onclick="togglePro()">

            <div class="bucketTop">
              <div style="min-width:0;">
                <div class="bucketTitle">Add Pro capabilities</div>
                <div class="bucketSub">Layer in advanced controls and automation.</div>
              </div>
              <div class="toggle" id="proToggle" role="switch" aria-checked="false"></div>
            </div>

            <div class="featureList" style="margin-top:12px;">
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Automation rules (if this → then that)</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Advanced permissions and role controls</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Priority routing and escalation</div>
              <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Custom fields and validation rules</div>
            </div>

            <div class="addRow">
              <div class="addMeta">
                <div class="addTitle">Enable Pro for this area</div>
                <div class="addSub">Adds advanced controls for this feature.</div>
              </div>
              <div style="font-weight:700;color:#0b1b2b;white-space:nowrap;" id="proStatus">Off</div>
            </div>
          </div>

          <button class="primaryBtn" id="capContinue" onclick="navTo('screen-onboarding')" disabled>
            Continue
          </button>
          <div class="microHint" id="capHint"></div>
        </div>
      </div>

      <!-- Screen 4: Onboarding selection -->
      <div class="screen off-right hidden" id="screen-onboarding" aria-hidden="true">
        <div class="topbar">
          <div class="backBtn" onclick="navBack()">
            <svg viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg>
          </div>
          <div class="title">Onboarding</div>
        </div>

        <div class="content">
          <div class="heroCard" style="margin-top:2px;">
            <div style="font-size:15px;font-weight:700;color:#0b1b2b;">How do you want to get set up?</div>
            <div class="mutedLine" style="margin-top:8px;">Pick an onboarding option, or continue without one.</div>
            <div class="miniGrid" style="margin-top:12px;">
              <div class="miniStat">
                <div class="k">Selected</div>
                <div class="v" id="obPlanLabel">—</div>
              </div>
              <div class="miniStat">
                <div class="k">Pro</div>
                <div class="v" id="obProLabel">Off</div>
              </div>
            </div>
          </div>

          <div class="choiceCard disabled" id="ob-launch" onclick="lockedLaunchOnboarding()">
            <div class="choiceTop">
              <div style="min-width:0;">
                <div class="choiceTitle">Segwik Launch Experience</div>
                <div class="choiceSub">We set up your workspace, map key workflows, and launch you with momentum.</div>
              </div>
              <div class="badge">Best for Segwik Start</div>
            </div>

            <div class="obMetaRow">
              <button type="button" class="obToggleBtn" id="obLaunchToggleBtn" onclick="event.stopPropagation(); toggleOnboardingFeatures('launch');">See more</button>
              <div class="radio" aria-hidden="true"><div class="dot"></div></div>
            </div>

            <div class="obFeatures featureList" id="obLaunchFeatures">

                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> 90-Minute 1:1 Success Training</div>
                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Professional Interactive eCard Setup</div>
                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Contact &amp; Phone Import</div>
                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Public Meeting Booker Configuration</div>
                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Core Journeys &amp; Follow-Up Automation</div>
                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> 30-Day Success Check-In</div>
              
            </div>
          </div>

          <div class="choiceCard" id="ob-growth" onclick="selectOnboarding('growth')">
            <div class="choiceTop">
              <div style="min-width:0;">
                <div class="choiceTitle">Segwik Growth Accelerator</div>
                <div class="choiceSub">We optimize your workspace, clean up structure, and build what you need to scale faster.</div>
              </div>
              <div class="badge">Best for Segwik Grow</div>
            </div>

            <div class="obMetaRow">
              <button type="button" class="obToggleBtn" id="obGrowthToggleBtn" onclick="event.stopPropagation(); toggleOnboardingFeatures('growth');">See more</button>
              <div class="radio" aria-hidden="true"><div class="dot"></div></div>
            </div>

            <div class="obFeatures featureList" id="obGrowthFeatures">

                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Basic Account Customization</div>
                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Custom Personas</div>
                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Event Publishing</div>
                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Sales &amp; Discovery Meeting Setup</div>
                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Meeting Customization &amp; Additional Training</div>
                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Journey Customization</div>
                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Email Blast Setup</div>
                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Content Generation Training</div>
              
            </div>
          </div>

          <div class="choiceCard" id="ob-custom" onclick="selectOnboarding('custom')">
            <div class="choiceTop">
              <div style="min-width:0;">
                <div class="choiceTitle">Segwik Pro White-Glove Setup</div>
                <div class="choiceSub">More involved buildout for teams with multiple workstreams and roles.</div>
              </div>
              <div class="badge">Best for Segwik Pro</div>
            </div>

            <div class="obMetaRow">
              <button type="button" class="obToggleBtn" id="obCustomToggleBtn" onclick="event.stopPropagation(); toggleOnboardingFeatures('custom');">See more</button>
              <div class="radio" aria-hidden="true"><div class="dot"></div></div>
            </div>

            <div class="obFeatures featureList" id="obCustomFeatures">

                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Everything in Growth Accelerator</div>
                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Multi-User &amp; Permissions Setup</div>
                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Advanced CRM &amp; Industry Modules</div>
                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Client Portal Configuration</div>
                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Advanced Telecom Systems</div>
                <div class="feat"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Quarterly Training Alignment</div>
              </div>

          </div>


          <div class="obNoRow" id="obNoRow" style="display:none;">
            <div class="obNoCheck">
              <span class="obNoIcon" aria-hidden="true">
                <svg viewBox="0 0 24 24" role="img" focusable="false" aria-hidden="true">
                  <path d="M8.6 2.8h6.8l5.8 5.8v6.8l-5.8 5.8H8.6L2.8 15.4V8.6L8.6 2.8z" fill="#dc2626"/>
                  <path d="M9 9l6 6M15 9l-6 6" stroke="#ffffff" stroke-width="2.4" stroke-linecap="round"/>
                </svg>
              </span>
              <span class="obNoText">Onboarding not included</span>
            </div>
          </div>


          <button type="button" class="skipBtn" id="ob-none" onclick="openNoOnboardingPrompt()">
            <span class="skipBtnLabel">I'd prefer to continue without guided assistance</span>
          </button>

          <button class="primaryBtn" onclick="navTo('screen-summary')">Continue</button>

        </div>
      </div>

      <!-- Screen 5: Summary (this is the only place pricing is displayed) -->
      <div class="screen off-right hidden" id="screen-summary" aria-hidden="true">
        <div class="topbar">
          <div class="backBtn" onclick="navBack()">
            <svg viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg>
          </div>
          <div class="title">Summary</div>
        </div>

        <div class="content">
          <div class="heroCard" style="margin-top:2px;">
            <div style="font-size:15px;font-weight:700;color:#0b1b2b;">Review and confirm</div>
            <div class="mutedLine" style="margin-top:8px;">Confirm what will be enabled for this feature.</div>
          </div>

          <div class="card">
            <div class="sectionTitle" style="margin-top:0;"><span class="dot"></span>What you’re enabling</div>

            <div class="summaryGrid">
              <div class="k">New subscription</div>
              <div class="v" id="sumNewPlan">—</div>

              <div class="k">Pro capabilities</div>
              <div class="v" id="sumPro">Off</div>

              <div class="k">Onboarding</div>
              <div class="v">
                <span id="sumOnboarding">None</span>
              </div>

              <div class="sumDetailRow" id="sumDetailRow">
                <button type="button" class="sumDetailBtn" id="sumDetailBtn" onclick="openSummaryDetails()">
                  See features and credits you're getting
                </button>
              </div>


            </div>

            <div class="divider"></div>

            <div class="sectionTitle" style="margin:0 0 8px;"><span class="dot"></span>Pricing</div>

            <div class="summaryGrid">
              <div class="k emph">Recurring (monthly)</div>
              <div class="v" id="sumRecurring">$0</div>

              <div class="k emph">One-time onboarding</div>
              <div class="v" id="sumOnetime">$0</div>
            </div>


            <button class="primaryBtn" id="confirmBtn" onclick="confirmUpgrade()">Confirm upgrade</button>
            <button class="secondaryBtn" onclick="navBack()">Go back</button>

            <div class="microHint" id="confirmHint">Your changes apply immediately after check-out</div>
          </div>
        </div>
      </div>

      <!-- Screen 6: Choose payment method (after Confirm upgrade) -->
      <div class="screen off-right hidden" id="screen-method" aria-hidden="true">
        <div class="topbar">
          <div class="backBtn" onclick="navBack()">
            <svg viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg>
          </div>
          <div class="title">Choose Payment Method</div>
        </div>

        <div class="content">
          <div class="heroCard">
            <div style="font-size:15px;font-weight:700;color:#0b1b2b;">Select a payment option</div>
            <div class="mutedLine" style="margin-top:8px;">Choose how you’d like to pay. You’ll enter details on the next step.</div>

            <div class="miniGrid oneCol">
              <div class="miniStat">
                <div class="k">Total due today</div>
                <div class="v" id="sumTotal">$0</div>
              </div>
            </div>
          </div>

          <div class="sectionTitle" style="margin-top:8px;"><span class="dot"></span>Payment methods</div>

          <div class="method" id="m-card" onclick="selectMethod('card')">
            <div class="methodTop">
              <div style="min-width:0;">
                <div class="methodTitle"><i class="fa-solid fa-credit-card" style="margin-right:6px; color: rgba(4,45,96,.78);" aria-hidden="true"></i>Credit / Debit Card</div>
                <div class="methodSub">Visa, Mastercard, American Express, Discover.</div>
              </div>
              <div class="radio" aria-hidden="true"><div class="dot"></div></div>
            </div>
          </div>

          <div class="method" id="m-apple" onclick="selectMethod('apple')">
            <div class="methodTop">
              <div style="min-width:0;">
                <div class="methodTitle"><i class="fa-brands fa-apple-pay" style="margin-right:6px; color: rgba(4,45,96,.78);" aria-hidden="true"></i>Apple Pay</div>
                <div class="methodSub">Use Apple Pay on supported devices.</div>
              </div>
              <div class="radio" aria-hidden="true"><div class="dot"></div></div>
            </div>
          </div>

          <div class="method" id="m-google" onclick="selectMethod('google')">
            <div class="methodTop">
              <div style="min-width:0;">
                <div class="methodTitle"><i class="fa-brands fa-google-pay" style="margin-right:6px; color: rgba(4,45,96,.78);" aria-hidden="true"></i>Google Pay</div>
                <div class="methodSub">Use Google Pay on supported devices.</div>
              </div>
              <div class="radio" aria-hidden="true"><div class="dot"></div></div>
            </div>
          </div>

          <div class="method" id="m-paypal" onclick="selectMethod('paypal')">
            <div class="methodTop">
              <div style="min-width:0;">
                <div class="methodTitle"><i class="fa-brands fa-paypal" style="margin-right:6px; color: rgba(4,45,96,.78);" aria-hidden="true"></i>PayPal</div>
                <div class="methodSub">You may be redirected to complete payment.</div>
              </div>
              <div class="radio" aria-hidden="true"><div class="dot"></div></div>
            </div>
          </div>

          <div class="method" id="m-ach" onclick="selectMethod('ach')">
            <div class="methodTop">
              <div style="min-width:0;">
                <div class="methodTitle"><i class="fa-solid fa-building-columns" style="margin-right:6px; color: rgba(4,45,96,.78);" aria-hidden="true"></i>Bank transfer (ACH)</div>
                <div class="methodSub">Common for business payments and invoices.</div>
              </div>
              <div class="radio" aria-hidden="true"><div class="dot"></div></div>
            </div>
          </div>

          <button class="primaryBtn" id="methodContinue" onclick="goToSelected()" disabled>Continue</button>
          <button class="secondaryBtn" onclick="navBack()">Back</button>

          <div class="securityNote" role="note" aria-label="Security note">
            <div class="secIcon" aria-hidden="true">
              <i class="fa-solid fa-lock"></i>
            </div>
            <div style="min-width:0;">
              <div class="secTitle">Secure payment</div>
              <div class="secText">Payment details are encrypted and stored securely.</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Screen 7: Card -->
      <div class="screen off-right hidden" id="screen-card" aria-hidden="true">
        <div class="topbar">
          <div class="backBtn" onclick="navBack()">
            <svg viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg>
          </div>
          <div class="title">Pay by Card</div>
        </div>

        <div class="content">
          <div class="heroCard">
            <div style="font-size:15px;font-weight:700;color:#0b1b2b;">Enter card details</div>
            <div class="mutedLine" style="margin-top:8px;">Review your information and confirm payment.</div>

            <div class="miniGrid oneCol" style="margin-top:12px;">
              <div class="miniStat">
                <div class="k">Due today</div>
                <div class="v" id="cardDue">$0</div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="sectionTitle" style="margin-top:0;"><span class="dot"></span>Card information</div>

            <div class="payShell">
              <div class="label" style="margin-bottom:6px;"><span>Card number</span></div>
              <div class="ccNumberWrap">
                <input class="ccField" id="ccNumber" inputmode="numeric" autocomplete="cc-number" placeholder="1234 1234 1234 1234" />
                <div class="brandStrip" aria-hidden="true">
                  <div class="brandLogo visa" title="Visa"></div>
                  <div class="brandLogo mc" title="Mastercard"></div>
                  <div class="brandLogo amex" title="American Express"></div>
                  <div class="brandLogo disc" title="Discover"></div>
                </div>
              </div>

              <div class="row" style="margin-top:10px;">
                <div class="col">
                  <div class="label" style="margin-bottom:6px;"><span>Expiration</span></div>
                  <input class="ccField" id="ccExp" inputmode="numeric" autocomplete="cc-exp" placeholder="MM / YY" />
                </div>
                <div class="col">
                  <div class="label" style="margin-bottom:6px;"><span>Security code</span></div>
                  <input class="ccField" id="ccCvc" inputmode="numeric" autocomplete="cc-csc" placeholder="123" />
                </div>
              </div>

              <div class="row">
                <div class="col">
                  <div class="label" style="margin-bottom:6px;"><span>Name on card</span></div>
                  <input class="ccField" id="ccName" autocomplete="cc-name" placeholder="Name" />
                </div>
              </div>

              <div class="row">
                <div class="col">
                  <div class="label" style="margin-bottom:6px;"><span>Billing ZIP / Postal code</span></div>
                  <input class="ccField" id="ccZip" inputmode="numeric" autocomplete="postal-code" placeholder="ZIP / Postal code" />
                </div>
              </div>

              <div class="row">
                <div class="col">
                  <div class="label" style="margin-bottom:6px;"><span>Receipt email</span></div>
                  <input class="ccField" id="ccEmail" inputmode="email" autocomplete="email" placeholder="you@company.com" />
                </div>
              </div>

              <div class="inlineInfo">
                <div class="i" aria-hidden="true"><i class="fa-solid fa-shield-halved"></i></div>
                <div class="t">
                  Your card details are protected with encryption. We store a secure payment method for future charges and renewals — not your full card number.
                </div>
              </div>
            </div>

            <button class="primaryBtn" id="cardPayBtn" onclick="fakePayToSuccess('cardPayBtn')">
              <span class="btnText">Pay now</span>
              <span class="btnSpinner" aria-hidden="true"></span>
            </button>
            <button class="secondaryBtn" onclick="navBack()">Back</button>
          </div>
        </div>
      </div>

      <!-- Screen 8: Apple Pay -->
      <div class="screen off-right hidden" id="screen-apple" aria-hidden="true">
        <div class="topbar">
          <div class="backBtn" onclick="navBack()">
            <svg viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg>
          </div>
          <div class="title">Apple Pay</div>
        </div>

        <div class="content">
          <div class="heroCard">
            <div style="font-size:15px;font-weight:700;color:#0b1b2b;">Apple Pay</div>
            <div class="mutedLine" style="margin-top:8px;">Use Apple Pay on supported devices.</div>
            <div class="miniGrid oneCol" style="margin-top:12px;">
              <div class="miniStat">
                <div class="k">Due today</div>
                <div class="v" id="appleDue">$0</div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="sectionTitle" style="margin-top:0;"><span class="dot"></span>Wallet checkout</div>
            <div class="mutedLine">When enabled, Segwik will present the Apple Pay sheet during checkout.</div>

            <button class="primaryBtn" id="applePayBtn" onclick="fakePayToSuccess('applePayBtn')">
              <span class="btnText">Pay with Apple Pay</span>
              <span class="btnSpinner" aria-hidden="true"></span>
            </button>
            <button class="secondaryBtn" onclick="navBack()">Back</button>
          </div>
        </div>
      </div>

      <!-- Screen 9: Google Pay -->
      <div class="screen off-right hidden" id="screen-google" aria-hidden="true">
        <div class="topbar">
          <div class="backBtn" onclick="navBack()">
            <svg viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg>
          </div>
          <div class="title">Google Pay</div>
        </div>

        <div class="content">
          <div class="heroCard">
            <div style="font-size:15px;font-weight:700;color:#0b1b2b;">Google Pay</div>
            <div class="mutedLine" style="margin-top:8px;">Use Google Pay on supported devices.</div>
            <div class="miniGrid oneCol" style="margin-top:12px;">
              <div class="miniStat">
                <div class="k">Due today</div>
                <div class="v" id="googleDue">$0</div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="sectionTitle" style="margin-top:0;"><span class="dot"></span>Wallet checkout</div>
            <div class="mutedLine">When enabled, Segwik will present the Google Pay sheet during checkout.</div>

            <button class="primaryBtn" id="googlePayBtn" onclick="fakePayToSuccess('googlePayBtn')">
              <span class="btnText">Pay with Google Pay</span>
              <span class="btnSpinner" aria-hidden="true"></span>
            </button>
            <button class="secondaryBtn" onclick="navBack()">Back</button>
          </div>
        </div>
      </div>

      <!-- Screen 10: PayPal -->
      <div class="screen off-right hidden" id="screen-paypal" aria-hidden="true">
        <div class="topbar">
          <div class="backBtn" onclick="navBack()">
            <svg viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg>
          </div>
          <div class="title">PayPal</div>
        </div>

        <div class="content">
          <div class="heroCard">
            <div style="font-size:15px;font-weight:700;color:#0b1b2b;">Pay with PayPal</div>
            <div class="mutedLine" style="margin-top:8px;">You’ll typically be redirected to PayPal to approve the payment and then returned to Segwik.</div>
            <div class="miniGrid oneCol" style="margin-top:12px;">
              <div class="miniStat">
                <div class="k">Due today</div>
                <div class="v" id="paypalDue">$0</div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="sectionTitle" style="margin-top:0;"><span class="dot"></span>How it works</div>
            <div class="mutedLine">
              - Select PayPal to continue.<br>
              - Segwik sends you to PayPal to sign in and approve.<br>
              - PayPal returns you to Segwik after approval.
            </div>

            <div class="divider"></div>

            <div class="sectionTitle" style="margin:0 0 8px;"><span class="dot"></span>Optional: connect PayPal</div>
            <div class="mutedLine">You can save PayPal as a checkout option for faster payment next time (availability depends on your plan and device).</div>

            <button class="primaryBtn" id="paypalBtn" onclick="fakePayToSuccess('paypalBtn')">
              <span class="btnText">Continue to PayPal</span>
              <span class="btnSpinner" aria-hidden="true"></span>
            </button>
            <button class="secondaryBtn" onclick="navBack()">Back</button>
          </div>
        </div>
      </div>

      <!-- Screen 11: ACH -->
      <div class="screen off-right hidden" id="screen-ach" aria-hidden="true">
        <div class="topbar">
          <div class="backBtn" onclick="navBack()">
            <svg viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg>
          </div>
          <div class="title">Bank transfer (ACH)</div>
        </div>

        <div class="content">
          <div class="heroCard">
            <div style="font-size:15px;font-weight:700;color:#0b1b2b;">Authorize a bank payment</div>
            <div class="mutedLine" style="margin-top:8px;">ACH payments may take 1–3 business days to settle.</div>
            <div class="miniGrid oneCol" style="margin-top:12px;">
              <div class="miniStat">
                <div class="k">Due today</div>
                <div class="v" id="achDue">$0</div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="sectionTitle" style="margin-top:0;"><span class="dot"></span>Bank details</div>

            <div class="payShell">
              <div class="row">
                <div class="col">
                  <div class="label" style="margin-bottom:6px;"><span>Account holder</span></div>
                  <input class="ccField" id="achName" placeholder="Name" />
                </div>
              </div>

              <div class="row">
                <div class="col">
                  <div class="label" style="margin-bottom:6px;"><span>Routing number</span></div>
                  <input class="ccField" id="achRouting" inputmode="numeric" placeholder="Routing number" />
                </div>
              </div>

              <div class="row">
                <div class="col">
                  <div class="label" style="margin-bottom:6px;"><span>Account number</span></div>
                  <input class="ccField" id="achAccount" inputmode="numeric" placeholder="Account number" />
                </div>
              </div>

              <div class="inlineInfo">
                <div class="i" aria-hidden="true"><i class="fa-solid fa-circle-info"></i></div>
                <div class="t">ACH payments may take 1–3 business days to settle, depending on the processor and bank.</div>
              </div>
            </div>

            <button class="primaryBtn" id="achAuthorizeBtn" onclick="fakePayToSuccess('achAuthorizeBtn')">
              <span class="btnText">Authorize bank transfer</span>
              <span class="btnSpinner" aria-hidden="true"></span>
            </button>
            <button class="secondaryBtn" onclick="navBack()">Back</button>
          </div>
        </div>
      </div>

      <!-- Screen 12: Success summary (post-payment) -->
      <div class="screen off-right hidden" id="screen-success" aria-hidden="true">
        <div class="topbar">
          <div class="backBtn" onclick="navBack()">
            <svg viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg>
          </div>
          <div class="title">Your access</div>
        </div>

        <div class="content" style="position:relative;">
          <!-- This is what gets blurred behind the popup -->
          <div id="successBody">
            <div class="successHero" style="margin-top:2px;">
              <div class="successHeroTitle">Your access is active</div>
              <div class="successHeroSub">Here's a summary of what’s now enabled on your account.</div>
            </div>

            <div class="card" style="margin-top:10px;">
              <div class="sectionTitle" style="margin-top:0;"><span class="dot"></span>Access summary</div>

              <div class="summaryGrid">
                <div class="k">Subscription</div>
                <div class="v" id="succPlan">—</div>

                <div class="k">Pro</div>
                <div class="v" id="succPro">Off</div>

                <div class="k">Telecommunications credits</div>
                <div class="v" id="succTelecom">—</div>

                <div class="k">Active connections credits</div>
                <div class="v" id="succConnections">—</div>

                <div class="k">User credits</div>
                <div class="v" id="succUsers">—</div>

                <div class="k">Onboarding package</div>
                <div class="v" id="succOnboarding">—</div>
              </div>

              <div class="divider"></div>

              <div class="sectionTitle" style="margin:0 0 8px;"><span class="dot"></span>Included features & credits</div>
              <div class="successListWrap" id="succIncludedList"></div>

              <div class="divider"></div>

              <div class="sectionTitle" style="margin:0 0 8px;"><span class="dot"></span>Charges</div>


              <div class="summaryGrid">
                <div class="k">Paid today</div>
                <div class="v" id="succPaidToday">$0</div>

                <div class="k">Recurring (monthly)</div>
                <div class="v" id="succRecurring">$0</div>

                <div class="k">One-time onboarding</div>
                <div class="v" id="succOnetime">$0</div>
              </div>

              <button class="primaryBtn" style="margin-top:12px;">
                Go back from where I came
              </button>
              <button class="secondaryBtn" style="margin-top:12px;">
                Go To Onboarding & Support Dashboard
              </button>

            </div>
          </div>


          <!-- Payment-confirmed popup (shows first, blurs background) -->
          <div class="payConfirmOverlay" id="payConfirmOverlay" aria-hidden="true">
            <div class="payConfirmCard">
              <div class="payConfirmTitle">Payment confirmed</div>
              <div class="payConfirmSub">Your payment was successful. Your access is now active.</div>
              <button class="primaryBtn" style="margin-top:12px;" onclick="closePaymentConfirmed()">
                Done
              </button>
            </div>
          </div>
        </div>
      </div>



    </div>


    <!-- bottom tabs -->
    <div class="tabs" id="tabs">
      <div class="tab">
        <svg viewBox="0 0 24 24"><path d="M3 10.5l9-7 9 7"/><path d="M9 22V12h6v10"/></svg>
        Home
      </div>
      <div class="tab">
        <svg viewBox="0 0 24 24"><path d="M16 11c1.66 0 3-1.34 3-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3z"/><path d="M8 11c1.66 0 3-1.34 3-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3z"/><path d="M8 13c-2.33 0-7 1.17-7 3.5V19h14v-2.5C15 14.17 10.33 13 8 13z"/><path d="M16 13c-.29 0-.62.02-1 .05 1.16.84 2 1.94 2 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/></svg>
        Contacts
      </div>
      <div class="tab">
        <svg viewBox="0 0 24 24"><path d="M4 6h16v14H4z"/><path d="M8 2v4M16 2v4"/><path d="M7 10h10M7 14h10"/></svg>
        My Card
      </div>
      <div class="tab">
        <svg viewBox="0 0 24 24"><path d="M4 4h6v6H4z"/><path d="M14 4h6v6h-6z"/><path d="M4 14h6v6H4z"/><path d="M14 14h6v6h-6z"/></svg>
        Scan Card
      </div>
      <div class="tab">
        <svg viewBox="0 0 24 24"><circle cx="5" cy="12" r="1.8"/><circle cx="12" cy="12" r="1.8"/><circle cx="19" cy="12" r="1.8"/></svg>
        More
      </div>
    </div>
        <!-- Summary details modal -->
    <div class="sumModalOverlay" id="sumDetailsModal" aria-hidden="true">
      <div class="sumModalCard">
        <div class="sumModalTop">
          <div class="sumModalTitle">What you’re getting</div>
          <button type="button" class="sumModalClose" onclick="closeSummaryDetails()" aria-label="Close">
            <svg viewBox="0 0 24 24"><path d="M6 6l12 12M18 6L6 18"/></svg>
          </button>
        </div>

        <div class="sumModalBody" id="sumDetailsBody">
          <!-- Filled by JS -->
        </div>

        <button class="primaryBtn" style="margin-top:12px;" onclick="closeSummaryDetails()">Done</button>
      </div>
    </div>

    <div class="modalOverlay" id="noOnboardingModal" aria-hidden="true">
      <div class="modalCard">
        <div class="modalTitle">Hey — quick check.</div>
        <div class="modalSub">
          If you skip guided onboarding, you’ll still be fine — but most people get value faster with help.
        </div>

        <div class="modalOptions">
          <div class="modalOption"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> Get started FAST with Segwik implementation and support services.</div>
          <div class="modalOption"><span class="check"><svg viewBox="0 0 24 24"><path d="M20 6L9 17l-5-5"/></svg></span> We’ll tailor it to your exact workflow so you don’t waste time</div>
        </div>

        <button class="primaryBtn" style="margin-top:12px;" onclick="keepOnboarding()">
          Keep guided onboarding
        </button>
        <button class="secondaryBtn" onclick="confirmNoOnboarding()">
          Continue without help
        </button>
      </div>
    </div>

    <div class="toast" id="toast"></div>
  </div>
</div>

<script>
  /* -----------------------
     STATE (set these from the place that triggered the upgrade)
     - featureName: what they tried to access
     - needsPlan: what tier is required (e.g., "Grow")
     - currentPlan: their current tier
  ------------------------ */
    /* -----------------------
     CHECKOUT STATE (ADD-ON)
  ------------------------ */
  const checkout = {
    totalDueToday: 0,
    selectedMethod: null
  };

  function money(n){
    const x = Number(n || 0);
    return "$" + x.toFixed(0);
  }

  function renderCheckoutTotals(){
    const total = money(checkout.totalDueToday);

    const sumTotal = byId("sumTotal");
    if(sumTotal) sumTotal.textContent = total;

    const ids = ["cardDue","appleDue","googleDue","paypalDue","achDue"];
    ids.forEach(id=>{
      const el = byId(id);
      if(el) el.textContent = total;
    });
  }

  function resetCheckoutUI(){
    checkout.selectedMethod = null;

    ["card","apple","google","paypal","ach"].forEach(x=>{
      const el = byId("m-"+x);
      if(el) el.classList.remove("active");
    });

    const btn = byId("methodContinue");
    if(btn) btn.disabled = true;
  }

  function selectMethod(which){
    checkout.selectedMethod = which;

    ["card","apple","google","paypal","ach"].forEach(x=>{
      const el = byId("m-"+x);
      if(!el) return;
      el.classList.toggle("active", x === which);
    });

    const btn = byId("methodContinue");
    if(btn) btn.disabled = !checkout.selectedMethod;
  }

  function goToSelected(){
    if(!checkout.selectedMethod){
      toast("Choose a payment method.");
      return;
    }
    const map = {
      card: "screen-card",
      apple: "screen-apple",
      google: "screen-google",
      paypal: "screen-paypal",
      ach: "screen-ach"
    };
    navTo(map[checkout.selectedMethod] || "screen-card");
  }

  function fakePayToSuccess(btnId){
    const btn = byId(btnId);
    if(!btn) return;

    if(btn.classList.contains("loading")) return;

    btn.classList.add("loading");
    btn.disabled = true;

    setTimeout(()=>{
      btn.classList.remove("loading");
      btn.disabled = false;

      // Go to the success summary screen
      navTo("screen-success");

      // Render summary + show the confirmation popup first
      requestAnimationFrame(()=>requestAnimationFrame(()=>{
        renderSuccessSummary();
        openPaymentConfirmed();
      }));
    }, 2000);
  }


  const state = {
    featureName: "Advanced Automations",
    needsPlan: "Grow",
    currentPlan: "Segwik Start",

    selectedPlan: null,    // "Grow"
    proEnabled: false,     // boolean
    onboarding: "growth",    // "none" | "launch" | "growth" | "custom"



    prices: {
      growMonthly: 39,
      proAddMonthly: 60,
      onboarding: { none: 0, launch: 500, growth: 999, custom: 999 }
    }

  };


  /* ---------- Navigation ---------- */
  const stack = ["screen-entry"];

  function byId(id){ return document.getElementById(id); }

  function navTo(id){
    const fromId = stack[stack.length - 1];
    if(fromId === id) return;
    if(id === "screen-capabilities") id = "screen-locked";


    const from = byId(fromId);
    const to = byId(id);

    const toContent = to.querySelector(".content");
    if(toContent) toContent.scrollTop = 0;

    to.classList.remove("hidden");
    to.classList.add("off-right");

    requestAnimationFrame(()=>requestAnimationFrame(()=>{
      from.classList.add("off-left");
      to.classList.remove("off-right");
    }));

    setTimeout(()=>{
      from.classList.add("hidden");
      from.classList.remove("off-left");
    }, 360);

    stack.push(id);
  }

  function navBack(){
    if(stack.length <= 1) return;

    const fromId = stack.pop();
    const toId = stack[stack.length - 1];

    const from = byId(fromId);
    const to = byId(toId);

    to.classList.remove("hidden");
    to.classList.remove("off-left","off-right");

    requestAnimationFrame(()=>requestAnimationFrame(()=>{
      from.classList.add("off-right");
    }));

    setTimeout(()=>{
      from.classList.add("hidden");
      from.classList.remove("off-right");
    }, 360);
  }

  /* ---------- Toast ---------- */
  let toastTimer = null;
  function toast(msg){
    const el = document.getElementById("toast");
    el.textContent = msg;
    el.classList.add("show");
    clearTimeout(toastTimer);
    toastTimer = setTimeout(()=> el.classList.remove("show"), 1600);
  }

  /* ---------- Entry / Locked screen ---------- */
  function toggleFullFeatures(){
    const panel = document.getElementById("fullFeaturesLocked");
    if(!panel) return;

    const btn = document.getElementById("fullFeaturesToggleBtn");

    const isHidden = (panel.style.display === "none" || panel.style.display === "");
    panel.style.display = isHidden ? "block" : "none";

    if(btn){
      btn.textContent = isHidden ? "Hide list" : "See full features";
    }

    if(isHidden){
      setTimeout(()=> panel.scrollIntoView({behavior:"smooth", block:"start"}), 0);
    }
  }
  function toggleBucketFeatures(which){
    const listId = (which === "pro") ? "proFeaturesList" : "growFeaturesList";
    const btnId  = (which === "pro") ? "proFeaturesToggleBtn" : "growFeaturesToggleBtn";

    const panel = document.getElementById(listId);
    const btn = document.getElementById(btnId);
    if(!panel || !btn) return;

    const isHidden = (panel.style.display === "none" || panel.style.display === "");
    panel.style.display = isHidden ? "block" : "none";
    btn.textContent = isHidden ? "Hide list" : "See full features";

    if(isHidden){
      setTimeout(()=> panel.scrollIntoView({behavior:"smooth", block:"start"}), 0);
    }
  }

  function quickSelectGrow(){
    // Same behavior as choosing Grow, but now selection happens on the Upgrade screen
    state.selectedPlan = "Grow";
    setBucketUI("grow");
    setCapContinueState();
    navTo("screen-locked");
  }

  function quickSelectGrowAndShowFeatures(){
    // Grow is mandatory. Show Grow features list inside the Grow bucket.
    state.selectedPlan = "Grow";
    setBucketUI("grow");
    setCapContinueState();

    const panel = document.getElementById("growFeaturesList");
    const btn = document.getElementById("growFeaturesToggleBtn");

    if(panel) panel.style.display = "block";
    if(btn) btn.textContent = "Hide list";

    if(panel){
      setTimeout(()=> panel.scrollIntoView({behavior:"smooth", block:"start"}), 0);
    }
  }




  function openLocked(featureName, needsPlan){
    state.featureName = featureName || state.featureName;
    state.needsPlan = needsPlan || state.needsPlan;

    // clean slate per attempt (Grow is mandatory)
    state.selectedPlan = "Grow";
    state.proEnabled = false;
    state.onboarding = "growth";



    // locked screen copy
    const fn = document.getElementById("featureName");
    if(fn) fn.textContent = state.featureName;
    const needEl = document.getElementById("needText");
    needEl.innerHTML = '<button type="button" class="planLinkBtn" onclick="quickSelectGrowAndShowFeatures()">Segwik ' + state.needsPlan + '</button>';


    const full = document.getElementById("fullFeaturesLocked");
    if(full) full.style.display = "none";
    const ffBtn = document.getElementById("fullFeaturesToggleBtn");
    if(ffBtn) ffBtn.textContent = "See full features";

    document.getElementById("currentPlan").textContent = state.currentPlan;
    // capabilities hero stats (screen may not be used)
    const capF = document.getElementById("capFeature");
    if(capF) capF.textContent = state.featureName;
    const capP = document.getElementById("capCurrentPlan");
    if(capP) capP.textContent = state.currentPlan;


    // reset UI (Grow mandatory)
    setBucketUI("grow");
    setProUI(false);
    setCapContinueState();


    // reset onboarding UI
    setOnboardingUI("growth");


    // go
    navTo("screen-locked");
  }

  /* ---------- Capabilities selection ---------- */
  function setBucketUI(which){
    const grow = document.getElementById("bucket-grow");
    if(!grow) return;
    if(which === "grow") grow.classList.add("active");
    else grow.classList.remove("active");
  }


  function setProUI(on){
    const t = document.getElementById("proToggle");
    const status = document.getElementById("proStatus");
    const bucket = document.getElementById("bucket-pro");
    state.proEnabled = !!on;

    if(state.proEnabled){
      if(t) { t.classList.add("on"); t.setAttribute("aria-checked","true"); }
      if(status) status.textContent = "Enabled";
      if(bucket) bucket.classList.add("active");
    } else {
      if(t) { t.classList.remove("on"); t.setAttribute("aria-checked","false"); }
      if(status) status.textContent = "Disabled";
      if(bucket) bucket.classList.remove("active");
    }
  }




  function setCapContinueState(){
    const btn = document.getElementById("capContinue");
    const hint = document.getElementById("capHint");
    if(btn) btn.disabled = false;
    if(hint) hint.textContent = "";
  }

  function selectBucket(which){
    if(which === "grow"){
      // If they click Grow while it's already selected, treat it as "trying to disable"
      if(state.selectedPlan === "Grow"){
        toast("Grow is required to upgrade.");
        return;
      }

      state.selectedPlan = "Grow";
      setBucketUI("grow");
      setCapContinueState();
    }
  }


  function togglePro(){
    if(state.selectedPlan !== "Grow"){
      toast("Select Grow first");
      return;
    }
    setProUI(!state.proEnabled);
  }
  /* ---------- Onboarding UI helpers ---------- */
  function toggleOnboardingFeatures(which){
    const map = {
      launch: { panelId:"obLaunchFeatures", btnId:"obLaunchToggleBtn" },
      growth: { panelId:"obGrowthFeatures", btnId:"obGrowthToggleBtn" },
      custom: { panelId:"obCustomFeatures", btnId:"obCustomToggleBtn" }
    };

    const entry = map[which];
    if(!entry) return;

    const panel = document.getElementById(entry.panelId);
    const btn = document.getElementById(entry.btnId);
    if(!panel || !btn) return;

    const isHidden = (panel.style.display === "none" || panel.style.display === "");
    panel.style.display = isHidden ? "block" : "none";
    btn.textContent = isHidden ? "Hide list" : "See full features";

    if(isHidden){
      setTimeout(()=> panel.scrollIntoView({behavior:"smooth", block:"start"}), 0);
    }
  }

  function openNoOnboardingPrompt(){
    const modal = document.getElementById("noOnboardingModal");
    if(!modal) return;
    modal.classList.add("show");
    modal.setAttribute("aria-hidden","false");
  }

  function closeNoOnboardingPrompt(){
    const modal = document.getElementById("noOnboardingModal");
    if(!modal) return;
    modal.classList.remove("show");
    modal.setAttribute("aria-hidden","true");
  }

  function keepOnboarding(){
    closeNoOnboardingPrompt();
    toast("Good call — we’ll keep it guided.");
  }

  function confirmNoOnboarding(){
    closeNoOnboardingPrompt();
    setOnboardingUI("none");
    toast("Okay — continuing without onboarding");
  }

  /* ---------- Onboarding selection ---------- */
    function lockedLaunchOnboarding(){
    toast("This package is only for Segwik free users.");
  }

  function setOnboardingUI(which){
    state.onboarding = which;

    const ids = ["none","launch","growth","custom"];

    ids.forEach(x=>{
      const el = document.getElementById("ob-"+x);
      if(!el) return;
      el.classList.remove("active");
    });

    const chosen = document.getElementById("ob-"+which);
    if(chosen) chosen.classList.add("active");

    // Toggle the "skip" button vs the "not included" row
    const noBtn = document.getElementById("ob-none");
    const noRow = document.getElementById("obNoRow");
    if(noBtn && noRow){
      if(which === "none"){
        noBtn.style.display = "none";
        noRow.style.display = "block";
      } else {
        noBtn.style.display = "flex";
        noRow.style.display = "none";
      }
    }

    document.getElementById("obPlanLabel").textContent = (state.selectedPlan || "—");
    document.getElementById("obProLabel").textContent = state.proEnabled ? "Enabled" : "Disabled";
  }



  function selectOnboarding(which){
    if(which === "none"){
      openNoOnboardingPrompt();
      return;
    }

    // Launch is visible but not selectable in this upgrade flow
    if(which === "launch"){
      toast("This package is only for Segwik free users.");
      return;
    }

    setOnboardingUI(which);

    const label =
      (which === "launch") ? "Launch Experience" :
      (which === "growth") ? "Growth Accelerator" :
      "White-Glove Setup";

    toast(label);
  }



  /* ---------- Summary + pricing ---------- */

  function computeRecurring(){
    let total = 0;
    if(state.selectedPlan === "Grow") total += state.prices.growMonthly;
    if(state.proEnabled) total += state.prices.proAddMonthly;
    return total;
  }

  function renderSummary(){
    document.getElementById("sumNewPlan").textContent = state.selectedPlan || "—";
    document.getElementById("sumPro").textContent = state.proEnabled ? "Enabled" : "Disabled";

    const obLabel =
      (state.onboarding === "none") ? "None" :
      (state.onboarding === "launch") ? "Segwik Launch Experience" :
      (state.onboarding === "growth") ? "Segwik Growth Accelerator" :
      "Segwik Pro White-Glove Setup";

    document.getElementById("sumOnboarding").textContent = obLabel;

    const recurring = computeRecurring();
    const onetime = state.prices.onboarding[state.onboarding] || 0;

    document.getElementById("sumRecurring").textContent = money(recurring);
    document.getElementById("sumOnetime").textContent = money(onetime);

    // Show/hide the details button based on whether there's anything meaningful to show
    const btn = document.getElementById("sumDetailBtn");
    const row = document.getElementById("sumDetailRow");
    if(btn){
      const hasPlan = !!state.selectedPlan;
      const hasPro = !!state.proEnabled;
      const hasOnboarding = (state.onboarding && state.onboarding !== "none");
      const show = (hasPlan || hasPro || hasOnboarding);

      btn.style.display = show ? "inline-flex" : "none";
      if(row) row.style.display = show ? "flex" : "none";
    }

  }




  // hook render on summary nav
  const _navTo = navTo;
  navTo = function(id){
    if(id === "screen-onboarding"){
      document.getElementById("obPlanLabel").textContent = (state.selectedPlan || "—");
      document.getElementById("obProLabel").textContent = state.proEnabled ? "Enabled" : "Disabled";
    }
    if(id === "screen-summary"){
      renderSummary();
    }
    if(id === "screen-success"){
      // Always keep the summary in sync if they revisit this screen
      renderSuccessSummary();

      // If the popup is still open for any reason, keep blur consistent
      const overlay = byId("payConfirmOverlay");
      const body = byId("successBody");
      const open = overlay && overlay.classList.contains("show");
      if(body) body.classList.toggle("blurred", !!open);
    }
    _navTo(id);
  };


  /* ---------- Confirm ---------- */
    /* ---------- Summary details modal ---------- */
  function openSummaryDetails(){
    const modal = document.getElementById("sumDetailsModal");
    const body = document.getElementById("sumDetailsBody");
    if(!modal || !body) return;

    body.innerHTML = buildSummaryDetailsHTML();

    modal.classList.add("show");
    modal.setAttribute("aria-hidden","false");
  }

  function closeSummaryDetails(){
    const modal = document.getElementById("sumDetailsModal");
    if(!modal) return;
    modal.classList.remove("show");
    modal.setAttribute("aria-hidden","true");
  }

  function buildSummaryDetailsHTML(){
    const parts = [];

    // Plan features / credits (we’ll reuse your locked-screen lists)
    const hasGrow = (state.selectedPlan === "Grow");
    const hasPro = !!state.proEnabled;

    if(hasGrow){
      parts.push('<div class="sumModalSection">Subscription: Segwik Grow</div>');
      parts.push(listFromDOM("growFeaturesList") || '<ul class="sumModalList"><li>Grow capabilities enabled.</li></ul>');
    }

    if(hasPro){
      parts.push('<div class="sumModalSection">Add-on: Pro capabilities</div>');
      parts.push(listFromDOM("proFeaturesList") || '<ul class="sumModalList"><li>Pro capabilities enabled.</li></ul>');
    }

    // Onboarding details (ONLY if included)
    if(state.onboarding && state.onboarding !== "none"){
      const obName =
        (state.onboarding === "launch") ? "Segwik Launch Experience" :
        (state.onboarding === "growth") ? "Segwik Growth Accelerator" :
        "Segwik Pro White-Glove Setup";

      const obListId =
        (state.onboarding === "launch") ? "obLaunchFeatures" :
        (state.onboarding === "growth") ? "obGrowthFeatures" :
        "obCustomFeatures";

      parts.push('<div class="sumModalSection">Onboarding: ' + obName + '</div>');
      parts.push(listFromDOM(obListId) || '<ul class="sumModalList"><li>Guided onboarding included.</li></ul>');
    }

    if(parts.length === 0){
      return '<ul class="sumModalList"><li>No details available.</li></ul>';
    }

    return parts.join("");
  }

  function listFromDOM(containerId){
    const el = document.getElementById(containerId);
    if(!el) return "";

    // Collect lines from your ".feat" rows (strip the icon)
    const rows = Array.from(el.querySelectorAll(".feat")).map(row=>{
      const clone = row.cloneNode(true);
      const icon = clone.querySelector(".check");
      if(icon) icon.remove();
      const text = (clone.textContent || "").replace(/\s+/g," ").trim();
      return text;
    }).filter(Boolean);

    if(rows.length === 0) return "";

    // If the first row is an "Everything in ... PLUS:" style line,
    // render it as a paragraph instead of a bullet.
    const first = rows[0] || "";
    const isPlusHeader =
      /^Everything in\b/i.test(first) ||
      /PLUS:\s*$/i.test(first);

    if(isPlusHeader){
      const rest = rows.slice(1);

      const headerHTML =
        '<div style="font-size:13px;font-weight:750;color:#0b1b2b;line-height:1.35;margin:0 0 8px;">'
        + escapeHTML(first)
        + '</div>';

      const listHTML =
        (rest.length > 0)
          ? ('<ul class="sumModalList">' + rest.map(t=>'<li>'+escapeHTML(t)+'</li>').join("") + '</ul>')
          : '';

      return headerHTML + listHTML;
    }

    // Default: bullets only
    return '<ul class="sumModalList">' + rows.map(t=>'<li>'+escapeHTML(t)+'</li>').join("") + '</ul>';
  }
function extractEntitlementLines(containerId){
  const el = document.getElementById(containerId);
  if(!el) return [];

  const rows = Array.from(el.querySelectorAll(".feat")).map(row=>{
    const clone = row.cloneNode(true);
    const icon = clone.querySelector(".check");
    if(icon) icon.remove();
    const text = (clone.textContent || "").replace(/\s+/g," ").trim();
    return text;
  }).filter(Boolean);

  // Remove the “Everything in ... PLUS:” header line (not an entitlement)
  return rows.filter(t => !/^Everything in\b/i.test(t) && !/PLUS:\s*$/i.test(t));
}


  function escapeHTML(str){
    return String(str)
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }
  function confirmUpgrade(){
    const btn = document.getElementById("confirmBtn");
    const hint = document.getElementById("confirmHint");

    if(state.selectedPlan !== "Grow"){
      toast("Select a plan first");
      return;
    }

    // Total due today = first month + one-time onboarding
    const recurring = computeRecurring();
    const onetime = state.prices.onboarding[state.onboarding] || 0;

    checkout.totalDueToday = recurring + onetime;

    // Prep checkout UI + totals
    resetCheckoutUI();
    renderCheckoutTotals();

    // Move into payment flow
    btn.disabled = false;
    hint.textContent = "Choose a payment method to complete check-out.";
    navTo("screen-method");
  }


  function hardResetToEntry(){
    // show entry, hide others
    const ids = ["screen-entry","screen-locked","screen-capabilities","screen-onboarding","screen-summary"];
    ids.forEach(id=>{
      const el = document.getElementById(id);
      el.classList.add("hidden","off-right");
      el.classList.remove("off-left");
    });
    const entry = document.getElementById("screen-entry");
    entry.classList.remove("hidden","off-right","off-left");

    // reset stack
    stack.length = 0;
    stack.push("screen-entry");

    // clean slate (keep currentPlan updated)
    state.selectedPlan = null;
    state.proEnabled = false;
    state.onboarding = "growth";

    setBucketUI(null);
    setProUI(false);
    setCapContinueState();
    setOnboardingUI("growth");

  }
  function openPaymentConfirmed(){
    const overlay = byId("payConfirmOverlay");
    const body = byId("successBody");
    if(overlay){
      overlay.classList.add("show");
      overlay.setAttribute("aria-hidden","false");
    }
    if(body){
      body.classList.add("blurred");
    }
  }

  function closePaymentConfirmed(){
    const overlay = byId("payConfirmOverlay");
    const body = byId("successBody");
    if(overlay){
      overlay.classList.remove("show");
      overlay.setAttribute("aria-hidden","true");
    }
    if(body){
      body.classList.remove("blurred");
    }
  }

  function renderSuccessSummary(){
    // Apply upgrade state (do NOT reset screens)
    state.currentPlan = state.selectedPlan;

    // Labels
    const plan = state.selectedPlan || "—";
    const pro = state.proEnabled ? "Enabled" : "Off";

    const obLabel =
      (state.onboarding === "none") ? "None" :
      (state.onboarding === "launch") ? "Segwik Launch Experience" :
      (state.onboarding === "growth") ? "Segwik Growth Accelerator" :
      "Segwik Pro White-Glove Setup";

    // Credits (simple summary based on your plan lists)
    // NOTE: Pro values override Grow values for telecom/user credits in this summary.
    const telecom = state.proEnabled ? 250 : 100;
    const connections = 500;
    const users = state.proEnabled ? 15 : 5;

    const recurring = computeRecurring();
    const onetime = state.prices.onboarding[state.onboarding] || 0;

    // Paid today = what checkout flow calculated (fallback to recurring+onetime)
    const paidToday = (typeof checkout.totalDueToday === "number")
      ? checkout.totalDueToday
      : (recurring + onetime);

    // Fill UI
    const elPlan = byId("succPlan"); if(elPlan) elPlan.textContent = plan;
    const elPro = byId("succPro"); if(elPro) elPro.textContent = pro;

    const elTele = byId("succTelecom"); if(elTele) elTele.textContent = telecom + " Credits";
    const elConn = byId("succConnections"); if(elConn) elConn.textContent = connections + " Credits";
    const elUsers = byId("succUsers"); if(elUsers) elUsers.textContent = users + " Credits";

    const elOb = byId("succOnboarding"); if(elOb) elOb.textContent = obLabel;

    const elPaid = byId("succPaidToday"); if(elPaid) elPaid.textContent = money(paidToday);
    const elRec = byId("succRecurring"); if(elRec) elRec.textContent = money(recurring);
    const elOne = byId("succOnetime"); if(elOne) elOne.textContent = money(onetime);
// Included features & credits (plan entitlements only — NOT onboarding)
const wrap = byId("succIncludedList");
if(wrap){
  const lines = [];

  if(state.selectedPlan === "Grow"){
    lines.push(...extractEntitlementLines("growFeaturesList"));
  }

  if(state.proEnabled){
    lines.push(...extractEntitlementLines("proFeaturesList"));
  }

  if(lines.length === 0){
    wrap.innerHTML = '<ul class="sumModalList"><li>No included items found.</li></ul>';
  } else {
    wrap.innerHTML = '<ul class="sumModalList">' + lines.map(t=>'<li>'+escapeHTML(t)+'</li>').join("") + '</ul>';
  }
}


  }

  /* ---------- Init ---------- */
  (function init(){
    hardResetToEntry();
  })();
</script>
</body>
</html>
